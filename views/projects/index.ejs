<%- include('../partials/header') %>
  <div class="container">
  <section class="section">
    <div class="page-head">
      <h1>Projetos abertos</h1>
      <% if (user) { %><a href="/projetos/publicar" class="btn btn-primary">Publicar projeto</a><% } %>
    </div>
    <% if (categories && categories.length) { %>
    <div class="filter-bar">
      <span class="filter-label">Categoria:</span>
      <a href="/projetos" class="filter-chip <%= !currentCategory ? 'active' : '' %>">Todas</a>
      <% categories.forEach(function(cat) { %>
      <a href="/projetos?categoria=<%= encodeURIComponent(cat) %>" class="filter-chip <%= currentCategory === cat ? 'active' : '' %>"><%= cat %></a>
      <% }); %>
    </div>
    <% } %>
    <% if (projects && projects.length) { %>
    <div class="projects-grid">
      <% projects.forEach(function(p) { %>
      <a href="/projetos/<%= p.id %>" class="project-card">
        <h3><%= p.title %></h3>
        <p class="excerpt"><%= (p.description || '').substring(0, 120) %>...</p>
        <div class="project-card-meta">
          <span class="tag"><%= p.category %></span>
          <span class="price">R$ <%= Number(p.budget).toLocaleString('pt-BR') %></span>
        </div>
        <small>Por <%= p.client_name %></small>
      </a>
      <% }); %>
    </div>
    <% } else { %>
    <p>Nenhum projeto aberto no momento. <% if (user) { %><a href="/projetos/publicar">Seja o primeiro a publicar</a>.<% } %></p>
    <% } %>
  </section>
  </div>
<%- include('../partials/footer') %>
