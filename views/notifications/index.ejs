<%- include('../partials/header') %>
<div class="container">
  <div class="section">
    <div class="page-head">
      <h1>Notificações</h1>
      <% if (notifications && notifications.length) { %>
      <form action="/notificacoes/ler-todas" method="post" style="display:inline">
        <button type="submit" class="btn btn-ghost btn-sm">Marcar todas como lidas</button>
      </form>
      <% } %>
    </div>
    <% if (notifications && notifications.length) { %>
    <ul class="notif-list">
      <% notifications.forEach(function(n) { %>
      <li class="notif-item <%= n.read_at ? 'read' : '' %>">
        <div class="notif-content">
          <strong><%= n.title %></strong>
          <% if (n.body) { %><p><%= n.body %></p><% } %>
          <small><%= new Date(n.created_at).toLocaleString('pt-BR') %></small>
        </div>
        <div class="notif-actions">
          <% if (n.link) { %><a href="<%= n.link %>" class="btn btn-ghost btn-sm">Ver</a><% } %>
          <% if (!n.read_at) { %>
          <form action="/notificacoes/<%= n.id %>/ler?redirect=/notificacoes" method="post" style="display:inline">
            <button type="submit" class="btn btn-ghost btn-sm">Marcar lida</button>
          </form>
          <% } %>
        </div>
      </li>
      <% }); %>
    </ul>
    <% } else { %>
    <p class="empty-state">Nenhuma notificação.</p>
    <% } %>
  </div>
</div>
<%- include('../partials/footer') %>
